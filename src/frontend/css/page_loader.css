/* Loader page */
#loader-fruna {
  position: fixed;
  inset: 0;
  z-index: 2147483000;
  display: grid;
  place-items: center;
  pointer-events: none;
  font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
}

#loader-fruna.hidden {
  display: none !important;
}

#loader-fruna.active {
  pointer-events: auto;
  display: grid !important;
}

/* Backdrop con gradiente animado */
#loader-fruna .lf-backdrop {
  position: absolute;
  inset: 0;
  background: linear-gradient(-45deg, #f5f5f5, #ffe4e1, #f8bbd0, #fff9fa);
  background-size: 400% 400%;
  animation: lf-gradient 8s ease infinite;
  opacity: 0.99;
}

@keyframes lf-gradient {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Stage */
#loader-fruna .lf-stage {
  position: relative;
  width: 100%;
  height: 100vh;
  overflow: hidden;
}

/* Dulces cayendo con mejor performance */
#loader-fruna .lf-stage img.lf-candy {
  position: absolute;
  left: 0;
  top: 0;
  width: clamp(32px, 7vw, 56px);
  max-width: none !important;
  height: auto;
  display: block;
  filter: drop-shadow(0 6px 8px rgba(0, 0, 0, 0.15));
  opacity: 0;
  transform: translate3d(var(--x, 0px), -40vh, 0) rotate(var(--r, 0deg)) scale(0.95);
  will-change: transform, opacity;
  animation: lf-fall var(--dur, 800ms) var(--delay, 0ms) linear infinite;
}

@keyframes lf-fall {
  0% {
    opacity: 0;
    transform: translate3d(var(--x), -40vh, 0) rotate(var(--r)) scale(0.95);
  }
  2% {
    opacity: 1;
  }
  100% {
    opacity: 1;
    transform: translate3d(
      calc(var(--x) + var(--drift, 0px)),
      100vh,
      0
    ) rotate(calc(var(--r) + 180deg)) scale(1);
  }
}

/* Fade-out optimizado */
#loader-fruna.done {
  animation: lf-fadeout 200ms ease forwards;
}

@keyframes lf-fadeout {
  to {
    opacity: 0;
    visibility: hidden;
  }
}

/* Reducir movimiento para accesibilidad */
@media (prefers-reduced-motion: reduce) {
  #loader-fruna .lf-backdrop {
    animation: none;
    background: #f5f5f5;
  }

  #loader-fruna .lf-stage img.lf-candy {
    animation: lf-fall-reduced 2s linear infinite !important;
  }

  @keyframes lf-fall-reduced {
    0% {
      opacity: 0;
      transform: translate3d(var(--x), -20vh, 0) scale(0.95);
    }
    10% {
      opacity: 1;
    }
    100% {
      opacity: 0.5;
      transform: translate3d(var(--x), 100vh, 0) scale(1);
    }
  }
}

/* Optimización para móviles */
@media (max-width: 768px) {
  #loader-fruna .lf-stage img.lf-candy {
    width: clamp(28px, 6vw, 48px);
  }
}
