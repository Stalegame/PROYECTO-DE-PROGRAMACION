<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registro FRUNA | La dulcería de Chile</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* Reset & base */
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:'Poppins','Arial',sans-serif;
      background:linear-gradient(135deg,#ffebee 0%,#fce4ec 50%,#f8bbd0 100%);
      min-height:100vh;
      display:flex;
      flex-direction:column;
      padding:20px;
      position:relative;
      color:#333;
    }

    /* Botón volver */
    .btn-volver{
      display:flex;align-items:center;gap:10px;
      position:fixed;left:60px;top:60px;
      background:#FFC107;color:#333;font-size:25px;font-weight:bold;
      padding:10px 28px;border-radius:30px;border:none;cursor:pointer;
      box-shadow:0 3px 8px rgba(0,0,0,.15);
      transition:all .3s ease;z-index:1000;
      text-decoration:none;appearance:none;
    }
    .btn-volver:hover{
        background:#FFD54F;
        transform:scale(1.05);
        text-decoration:none}

    /* Wrapper centrado */
    .contenedor-principal{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      flex:1;
      width:100%;
      max-width:560px;
      margin:40px auto 20px;
    }

    /* Header con gradiente */
    header{
      background:linear-gradient(135deg,#e91e63 0%,#ad1457 100%);
      width:100%;padding:20px;border-radius:15px 15px 0 0;
      box-shadow:0 5px 15px rgba(0,0,0,.1);text-align:center;
      margin-bottom:-10px;z-index:10;
    }
    .logo-container{max-width:220px;margin:0 auto;filter:drop-shadow(0 3px 5px rgba(0,0,0,.2))}
    .logo-container .wordmark{color:#fff;font-size:28px;font-weight:bold}

    /* Caja del formulario */
    .registro-box{
      background:#fff;border-radius:0 0 15px 15px;padding:40px 30px;
      box-shadow:0 10px 30px rgba(0,0,0,.1);position:relative;overflow:hidden;width:100%;
    }
    .registro-box::before{
      content:'';position:absolute;top:0;left:0;right:0;height:5px;
      background:linear-gradient(90deg,#E91E63,#FFC107,#E91E63);
    }
    .registro-box h3{
      margin-bottom:10px;color:#E91E63;text-align:center;font-size:24px;font-weight:600;
    }
    .subtitle{
      text-align:center;color:#777;margin-bottom:25px;font-size:15px;
    }

    /* Grupos de campos al estilo de tu login */
    .form-group{
      display:flex;align-items:center;margin-bottom:16px;
      background:#f9f9f9;border-radius:12px;border:2px solid #f1f1f1;
      padding:5px 15px;transition:all .3s ease;
    }
    .form-group:focus-within{
      border-color:#E91E63;box-shadow:0 0 0 3px rgba(233,30,99,.1);
      transform:translateY(-2px);
    }
    .form-group i{font-size:18px;color:#E91E63;margin-right:10px}
    .form-group input,.form-group textarea{
      border:none;outline:none;flex:1;padding:14px 10px;font-size:16px;
      background:transparent;color:#333;
    }
    .form-group textarea{resize:vertical;min-height:86px}
    .form-group input::placeholder,.form-group textarea::placeholder{color:#999}

    /* Botón principal (degradé rosa) */
    .btn-registrar{
      width:100%;
      background:linear-gradient(135deg,#E91E63 0%,#C2185B 100%);
      color:#fff;font-size:16px;font-weight:600;padding:15px;border-radius:12px;
      border:none;cursor:pointer;transition:all .3s ease;
      box-shadow:0 5px 15px rgba(233,30,99,.3);margin-top:6px;
    }
    .btn-registrar:hover{
      background:linear-gradient(135deg,#C2185B 0%,#E91E63 100%);
      transform:translateY(-3px);box-shadow:0 8px 20px rgba(233,30,99,.4);
    }
    .btn-registrar:active{transform:translateY(0)}

    /* Enlace “ya tengo cuenta” */
    .login-links{display:flex;justify-content:center;margin-top:18px;font-size:14px}
    .login-links a{color:#E91E63;text-decoration:none;transition:color .3s}
    .login-links a:hover{color:#C2185B;text-decoration:underline}

    /* Loading dots (igual estilo) */
    .loading{display:none;text-align:center;margin-top:15px}
    .loading-dots{display:inline-block;position:relative;width:80px;height:20px}
    .loading-dots div{
      position:absolute;top:0;width:13px;height:13px;border-radius:50%;
      background:#E91E63;animation-timing-function:cubic-bezier(0,1,1,0);
    }
    .loading-dots div:nth-child(1){left:8px;animation:loading-dots1 .6s infinite}
    .loading-dots div:nth-child(2){left:8px;animation:loading-dots2 .6s infinite}
    .loading-dots div:nth-child(3){left:32px;animation:loading-dots2 .6s infinite}
    .loading-dots div:nth-child(4){left:56px;animation:loading-dots3 .6s infinite}
    @keyframes loading-dots1{0%{transform:scale(0)}100%{transform:scale(1)}}
    @keyframes loading-dots3{0%{transform:scale(1)}100%{transform:scale(0)}}
    @keyframes loading-dots2{0%{transform:translate(0,0)}100%{transform:translate(24px,0)}}

    /* Responsive */
    @media (max-width:600px){
      .btn-volver{left:15px;top:15px;font-size:13px;padding:8px 12px;position:absolute}
      .contenedor-principal{margin-top:60px}
      header{padding:15px}
      .registro-box{padding:30px 20px}
    }
  </style>
</head>
<body>
  <!-- Botón Volver -->
  <a href="login_users.html" class="btn-volver">
    <i class="fas fa-arrow-left"></i>
    Volver
  </a>

  <div class="contenedor-principal">
    <header>
      <div class="logo-container">
        <div class="wordmark">FRUNA</div>
      </div>
    </header>

    <div class="registro-box">
      <h3>Crear cuenta</h3>
      <p class="subtitle">Completa tus datos para comenzar a disfrutar de FRUNA</p>

      <!-- Envío directo a tu endpoint del router -->
      <form id="form-registro" action="/api/clients/register" method="POST">
        <div class="form-group">
          <i class="fas fa-user"></i>
          <input type="text" id="nombre" name="nombre" placeholder="Nombre completo" required />
        </div>

        <div class="form-group">
          <i class="fas fa-envelope"></i>
          <input type="email" id="email" name="email" placeholder="correo@ejemplo.com" required />
        </div>

        <div class="form-group">
          <i class="fas fa-lock"></i>
          <input type="password" id="password" name="password" placeholder="Crea una contraseña" required />
        </div>

        <div class="form-group">
          <i class="fas fa-phone"></i>
          <input type="text" id="telefono" name="telefono" placeholder="Ej: +56912345678" />
        </div>

        <div class="form-group">
          <i class="fas fa-location-dot"></i>
          <textarea id="direccion" name="direccion" placeholder="Ingresa tu dirección"></textarea>
        </div>

        <button type="submit" class="btn-registrar">
          <i class="fas fa-user-plus"></i> Registrarme
        </button>

        <div class="loading" id="loading">
          <div class="loading-dots"><div></div><div></div><div></div><div></div></div>
        </div>
      </form>

      <div class="login-links">
        <span>¿Ya tienes cuenta?&nbsp;</span>
        <a href="login_users.html">Inicia sesión</a>
      </div>
    </div>

    <div class="footer" style="text-align:center;margin-top:30px;color:#777;font-size:13px;width:100%;">
      © 2025 FRUNA Chile - Todos los derechos reservados
    </div>
  </div>

  <script>
  (function () {
    const form = document.getElementById('form-registro');
    const loading = document.getElementById('loading');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const btn = form.querySelector('.btn-registrar');
      btn.disabled = true;
      loading.style.display = 'block';

      const fd = new FormData(form);
      const body = new URLSearchParams(fd);

      try {
        const res = await fetch('/api/clients/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body
        });

        let data = {};
        try { data = await res.json(); } catch (_) {}

        if (!res.ok || data.success === false) {
          let msg = (data && data.error) || 'No se pudo registrar. Revisa tus datos.';
          if (data && data.details) {
            const details = Array.isArray(data.details)
              ? data.details
              : Object.values(data.details).map(d => d.msg || d);
            if (details && details.length) msg += '\n- ' + details.join('\n- ');
          }
          alert(msg);
          return;
        }

        alert('¡Registro exitoso! Ya puedes iniciar sesión.');
        window.location.href = 'login_users.html';
      } catch (err) {
        alert('Error de conexión. Intenta nuevamente.');
      } finally {
        btn.disabled = false;
        loading.style.display = 'none';
      }
    });

    // Efectos de enfoque
    document.querySelectorAll('input, textarea').forEach(el => {
      el.addEventListener('focus', () => {
        el.parentElement.style.transform='translateY(-2px)';
        el.parentElement.style.boxShadow='0 5px 15px rgba(0,0,0,0.1)';
      });
      el.addEventListener('blur', () => {
        el.parentElement.style.transform='translateY(0)';
        el.parentElement.style.boxShadow='none';
      });
    });
  })();
</script>

</body>
</html>
